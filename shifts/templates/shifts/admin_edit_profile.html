{% extends "shifts/base.html" %}

{% block title %}{{ target_user.last_name }} {{ target_user.first_name }} - プロフィール編集{% endblock %}
{% block nav_profiles %}bg-gray-600{% endblock %}

{% block content %}
<div class="mb-4">
    <a href="{% url 'shifts:admin_user_profiles' %}" class="text-blue-600 hover:text-blue-800 text-sm">&larr; スタッフ設定に戻る</a>
</div>

<h1 class="text-2xl font-bold mb-6">{{ target_user.last_name }} {{ target_user.first_name }} のプロフィール編集</h1>

<form method="post" class="bg-white rounded-lg shadow p-6 max-w-lg">
    {% csrf_token %}

    <div class="space-y-5">
        <!-- 運転可能 -->
        <div class="flex items-center">
            <input type="checkbox" id="can_drive" name="can_drive"
                   class="h-4 w-4 text-blue-600 rounded border-gray-300"
                   {% if profile.can_drive %}checked{% endif %}>
            <label for="can_drive" class="ml-2 text-sm font-medium text-gray-700">運転可能</label>
        </div>

        <!-- 勤務形態 -->
        <div>
            <label for="work_pattern" class="block text-sm font-medium text-gray-700 mb-1">勤務形態</label>
            <select id="work_pattern" name="work_pattern"
                    class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm">
                {% for value, label in work_pattern_choices %}
                    <option value="{{ value }}" {% if profile.work_pattern == value %}selected{% endif %}>{{ label }}</option>
                {% endfor %}
            </select>
        </div>

        <!-- アプリ利用 -->
        <div class="flex items-center">
            <input type="checkbox" id="uses_app" name="uses_app"
                   class="h-4 w-4 text-blue-600 rounded border-gray-300"
                   {% if profile.uses_app %}checked{% endif %}>
            <label for="uses_app" class="ml-2 text-sm font-medium text-gray-700">アプリ利用</label>
        </div>

        <!-- 最低出勤日数/週 -->
        <div>
            <label for="min_shifts_per_week" class="block text-sm font-medium text-gray-700 mb-1">最低出勤日数/週</label>
            <input type="number" id="min_shifts_per_week" name="min_shifts_per_week"
                   value="{{ profile.min_shifts_per_week }}" min="0" max="7"
                   class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm">
        </div>

        <!-- 最大出勤日数/週 -->
        <div>
            <label for="max_shifts_per_week" class="block text-sm font-medium text-gray-700 mb-1">最大出勤日数/週</label>
            <input type="number" id="max_shifts_per_week" name="max_shifts_per_week"
                   value="{{ profile.max_shifts_per_week }}" min="0" max="7"
                   class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm">
        </div>

        <!-- 固定出勤曜日 -->
        <div>
            <label for="fixed_weekdays" class="block text-sm font-medium text-gray-700 mb-1">固定出勤曜日</label>
            <input type="text" id="fixed_weekdays" name="fixed_weekdays"
                   value="{{ profile.fixed_weekdays }}" placeholder="0,1,2 (0=月,1=火,...,6=日)"
                   class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm">
            <p class="mt-1 text-xs text-gray-500">カンマ区切り: 0=月, 1=火, 2=水, 3=木, 4=金, 5=土, 6=日</p>
        </div>

        <!-- デフォルト売り場 -->
        <div>
            <label for="default_location" class="block text-sm font-medium text-gray-700 mb-1">デフォルト売り場</label>
            <select id="default_location" name="default_location"
                    class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm">
                <option value="">-- なし --</option>
                {% for loc in locations %}
                    <option value="{{ loc.id }}" {% if profile.default_location_id == loc.id %}selected{% endif %}>{{ loc.name }}</option>
                {% endfor %}
            </select>
            <p class="mt-1 text-xs text-gray-500">自動割当で使用されるデフォルトの売り場</p>
        </div>
    </div>

    <div class="mt-6 flex items-center gap-3">
        <button type="submit"
                class="bg-blue-600 text-white px-4 py-2 rounded-md text-sm font-medium hover:bg-blue-700">
            保存
        </button>
        <a href="{% url 'shifts:admin_user_profiles' %}"
           class="text-gray-600 hover:text-gray-800 text-sm">キャンセル</a>
    </div>
</form>
{% endblock %}
