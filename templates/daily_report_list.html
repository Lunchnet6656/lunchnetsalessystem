<!DOCTYPE html>
{% extends 'base.html' %}

{% block title %}日計表データ確認{% endblock %}

{% block content %}
{% load custom_filters %}

<div class="container mt-4">
    <h1 class="mb-1">日計表 送信結果</h1>
    <hr class="my-4">
    <!-- 検索フォーム -->
    <form method="get" class="mb-4">
        <div class="row">
            <div class="col-md-12">
                <label for="search_date_start" class="form-label fs-4">日付範囲</label>
            </div>
            <div class="col-md-4">
                <div class="input-group">
                    <label for="search_date_start" class="form-label">開始日</label>
                    <input type="date" id="search_date_start" name="search_date_start" value="{{ search_date_start }}" class="form-control">
                </div>
            </div>
            <div class="col-md-1 d-flex align-items-center justify-content-center">
                <span　style="font-size: 1.5rem; width: 1rem;">〜</span>
            </div>
            <div class="col-md-4">
                <div class="input-group">
                    <label for="search_date_end" class="form-label">終了日</label>
                    <input type="date" id="search_date_end" name="search_date_end" value="{{ search_date_end }}" class="form-control">
                </div>
            </div>
            <div class="col-md-2">
                <button class="btn btn-primary w-100" type="submit">検索</button>
            </div>
        </div>
    </form>


    <!-- レポート一覧 -->
    <table class="table table-striped">
        <thead>
            <tr>
                <th>日付</th>
                <th>レポート数</th>
                <th>最終更新日時</th>
            </tr>
        </thead>
        <tbody>
            {% for report in aggregated_reports %}
            <tr>
                <td><a href="{% url 'daily_report_detail' report.date %}">{{ report.date|japanese_date }}</a></td>
                <td>{{ report.count }} / {{ total_locations }}</td>
                <td>{{ report.latest_update|date:"Y/m/d H:i" }}</td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="3" class="text-center">データがありません</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    <!-- CSV ダウンロードボタン -->
    <a href="{% url 'download_csv_allreport' %}?search_date_start={{ search_date_start }}&search_date_end={{ search_date_end }}" class="btn btn-secondary">CSVダウンロード</a>

</div>


{% endblock %}
